# EDA

## Container Diagram
![Container Diagram for EDA (Event-Driven Ansible) System - Actual Pod Architecture -Full](https://kroki.io/c4plantuml/svg/eNqtV21v2zYQ_q5fcTMG1AaSqt0LMAwYULf2kmBp60TJggEDDIqibc4UqZFUEmPof9-RFPUWd02BGUFs0bx7nns_vzGWaFuXIvmGSyrqgsHO2sr8nKaaPLzccrur89owTZW0TNqXVJVpJYh0MqfGFoLn6bsfTlfu6Pb9ZVoSY5nGo_U7lCBcMv2ycvqTy_kfH29v1ncXN-fry-XZ8sNiOksSy61g0N6FBSdbTUrYKA3LxRymy3uEPV1oju8wl4bngs0gOyBMCacwp7YmAlaqgLmmO24ZHmiWJCumjZJTx_0EJrf4NjmBP5NJI0mKkkturCYWkfCvYPdMqAoplESSLZdbILVVJbFcyQlKzpIgul4-2il7RCslEWvjzxBh2Zw01EwfzYDdEQtW8-0WAZgzyThQzShDw0AqyzeceiwzcVgR7K2qZUH0YcoK0gNDz4QLkxn8kwC-_L_2Nqn4ulIFXp2vLrx3pt8DjV42s1bMvVrvTyXa_bhGYRT84D7DSqvHA9oy8V95o6LY5BoN0YZB5e6cAKaS5RQ2XDBzAll2CegR9LK3CqaV0hZ-evXq1WygBb41lcaw_TJ5YPk61-rBhWp2hFyg5UxHmxyl1cHulEwXfxG5VelZLTlVWo44LrMbdx9QK7KFKZdNnCKf74Z8WjpB4CiTglQ7yRoyC__Q4zPPzi6GJO5Ynim6Zzay2PjYE3FqeckwLmXpyI8c9fo_HGW8uobcpyMJ4HNsjfnNSNlkgq8kyPxRSInvnp0SXt3XJ4U31MtCoPLZNHh2FvQNGxn13JwIMkiQMmNcoX91bpQoSLbMEd23PHth6OjWMWdvfcpeM0JtivnQ6nXJAR54QygLVAq45wQuFSneEmystOldX_DTCBmB-L1PqfWD0nvfBuftGdz5M9Pz2fVVR2r5yGhtGehasFypPXTaDNTeaddXEPQal0hcYvkjUzM7QtVfO86yYBtSC9tRXISDL_A7J7LAuZETut9ql_Ngidn_v9QM3bEC7dex4cbnAafBcfTeYv7CAK0Nzg9o1fhiwAHDVYFtMvD9Aj0qsM6PslvkWEnGbrXrtZNV-JhdXWI7siQnJjSk7vj1jx29DEceM368Yv1v-LbWIbInbbzxYy_i-IAeJnXBLQi1NV1RtEyLCPsZspoV3PgCwHd4R9Apk_jYMXsf6gpCXXmHoYcdOEUJF1pBDseqgXqFs-RTknQBdNPcjfcmfh-bR4d7ptLf6hyLnVn0hBPRSsQYTt67DSB6KEQRHaZqjVHybApWCXUoXRsRfMPogQrmRVtC-1Y7skpegFtAQpk7v6JPk2smmu3E9wi84JP9_OZmlaXuPwp2d_qT2Y0zSoRo76duygWcdg0Ju8JTyCeby7DBZ0wWptlQWvXYos5dUjSMjnSWY_uQ7yAGGnCn7HeCyV8b13qtoko0vrno2m6BjhYh6Xa8Cox7pgf73fjhqPmJH7rpgo17NhZup3aUb8fyU_nXQ_nGO6PZE_UMvTUi4WJ_cSTyfBjTX5nFDDbg6mgc1ni_NeC6XR3qCgVC4nTWeNDYB9rqcXuGlKzHwSP3ugiqLUx65xLYa8S-ESPubsYS9sXbMQ0VvWpC6sCdROQ6Vt-Kdcrj1ah_VedpVuef1z0MQw-haWxdPDqQoUyEuqpZPRA4Dngk4Z_ntqdyEfkG2z_87eA97FUaOmH03mgqPgttLPQ8qN6UiwJxopkwpJxUA9G7_CSw8bseK0zD2HRHde21df158OOm6b5OTa9Hu53fa8xwQ-K4KSFXqnBtO4zrfFSlbXfBPcHiCBnpbdQ53dn5x7veT9M32Arxl-u_nA3cQw==)

Links:
- [Full](https://kroki.io/c4plantuml/svg/eNqtV21v2zYQ_q5fcTMG1AaSqt0LMAwYULf2kmBp60TJggEDDIqibc4UqZFUEmPof9-RFPUWd02BGUFs0bx7nns_vzGWaFuXIvmGSyrqgsHO2sr8nKaaPLzccrur89owTZW0TNqXVJVpJYh0MqfGFoLn6bsfTlfu6Pb9ZVoSY5nGo_U7lCBcMv2ycvqTy_kfH29v1ncXN-fry-XZ8sNiOksSy61g0N6FBSdbTUrYKA3LxRymy3uEPV1oju8wl4bngs0gOyBMCacwp7YmAlaqgLmmO24ZHmiWJCumjZJTx_0EJrf4NjmBP5NJI0mKkkturCYWkfCvYPdMqAoplESSLZdbILVVJbFcyQlKzpIgul4-2il7RCslEWvjzxBh2Zw01EwfzYDdEQtW8-0WAZgzyThQzShDw0AqyzeceiwzcVgR7K2qZUH0YcoK0gNDz4QLkxn8kwC-_L_2Nqn4ulIFXp2vLrx3pt8DjV42s1bMvVrvTyXa_bhGYRT84D7DSqvHA9oy8V95o6LY5BoN0YZB5e6cAKaS5RQ2XDBzAll2CegR9LK3CqaV0hZ-evXq1WygBb41lcaw_TJ5YPk61-rBhWp2hFyg5UxHmxyl1cHulEwXfxG5VelZLTlVWo44LrMbdx9QK7KFKZdNnCKf74Z8WjpB4CiTglQ7yRoyC__Q4zPPzi6GJO5Ynim6Zzay2PjYE3FqeckwLmXpyI8c9fo_HGW8uobcpyMJ4HNsjfnNSNlkgq8kyPxRSInvnp0SXt3XJ4U31MtCoPLZNHh2FvQNGxn13JwIMkiQMmNcoX91bpQoSLbMEd23PHth6OjWMWdvfcpeM0JtivnQ6nXJAR54QygLVAq45wQuFSneEmystOldX_DTCBmB-L1PqfWD0nvfBuftGdz5M9Pz2fVVR2r5yGhtGehasFypPXTaDNTeaddXEPQal0hcYvkjUzM7QtVfO86yYBtSC9tRXISDL_A7J7LAuZETut9ql_Ngidn_v9QM3bEC7dex4cbnAafBcfTeYv7CAK0Nzg9o1fhiwAHDVYFtMvD9Aj0qsM6PslvkWEnGbrXrtZNV-JhdXWI7siQnJjSk7vj1jx29DEceM368Yv1v-LbWIbInbbzxYy_i-IAeJnXBLQi1NV1RtEyLCPsZspoV3PgCwHd4R9Apk_jYMXsf6gpCXXmHoYcdOEUJF1pBDseqgXqFs-RTknQBdNPcjfcmfh-bR4d7ptLf6hyLnVn0hBPRSsQYTt67DSB6KEQRHaZqjVHybApWCXUoXRsRfMPogQrmRVtC-1Y7skpegFtAQpk7v6JPk2smmu3E9wi84JP9_OZmlaXuPwp2d_qT2Y0zSoRo76duygWcdg0Ju8JTyCeby7DBZ0wWptlQWvXYos5dUjSMjnSWY_uQ7yAGGnCn7HeCyV8b13qtoko0vrno2m6BjhYh6Xa8Cox7pgf73fjhqPmJH7rpgo17NhZup3aUb8fyU_nXQ_nGO6PZE_UMvTUi4WJ_cSTyfBjTX5nFDDbg6mgc1ni_NeC6XR3qCgVC4nTWeNDYB9rqcXuGlKzHwSP3ugiqLUx65xLYa8S-ESPubsYS9sXbMQ0VvWpC6sCdROQ6Vt-Kdcrj1ah_VedpVuef1z0MQw-haWxdPDqQoUyEuqpZPRA4Dngk4Z_ntqdyEfkG2z_87eA97FUaOmH03mgqPgttLPQ8qN6UiwJxopkwpJxUA9G7_CSw8bseK0zD2HRHde21df158OOm6b5OTa9Hu53fa8xwQ-K4KSFXqnBtO4zrfFSlbXfBPcHiCBnpbdQ53dn5x7veT9M32Arxl-u_nA3cQw==)
- [No Description](https://kroki.io/c4plantuml/svg/eNqtV_9rGzcU__3-ijcziA1Jr-02GINB3dpLwtLWySULg4GRdbKtWSfdJF0SM_q_70k63Te7azpmQuyT9d7n874_vzGWaFsVIvmGSyqqnMHW2tL8lKaaPL7YcLutVpVhmippmbQvqCrSUhDpZM6MzQVfpe--P1u4o7v3V2lBjGUaj5bvUIJwyfSL0ulPrqa_f7y7Xd5f3l4sr-bn8w-z8SRJLLeCQXMXZpxsNClgrTTMZ1MYzx8Q9mymOb7DVBq-EmwC2R5hCjiDKbUVEbBQOUw13XLL8ECzJFkwbZQcO-6nMLrDt9Ep_JGcnJyMamGSF1xyYzWxCIZ_OXtgQpXIoiCSbLjcAKmsKojlSo5QeJIE0eX8yY7ZExoqiVgaf4Yg8_qkZmcGgAbslliwmm82iMGcYcbhakYZmgdSWb7m1MOZkYOLeG9VJXOi92OWkw4e-idcGE3g7wTw5f81t0nJl6XK8ep0cel9NP4OaPS1mTRi7tXEYCzR9KclCqPgB_cZFlo97dGckf_K2xXFnH03aIs2DEp37RQwpyynsOaCmVPIsitAv6CvvWEwLpW28OPLly8nPUXwrSk1xu_n0SNbLVdaPbqYTY7wC8yc9WiWY7XY262S6exPIjcqPa8kp0rLQ5rz7NaJACpGwjDmsg5YpPS6T6lhFASOkslJuZWs5jPzDx1K0-z88oDHPVtliu6YjUTWPgmIOLO8YBigonAmDNz16l_cZby6mt-nI5ngk22Juc5IUaeELyzI_FHIjdfPzg2v7j9lh7fVi0Ng89l8eHY6dG0b2PUVyRHEkCNlxrjS_-okKVCQbJjjumuodoLRMq5i_t759L1hhNoUs6LRW2cJeOw1oSywyeGBE7hSJH9LsOHSuqd9wVsDcMTiDz63lo9K73x7nDZncO_PTMdzN9c9XvMnRivLQFeCrZTaQavQQOVdd3MNQbVxScUlNgQkayZH2Pprx4nmbE0qYVuWs3DwZYoXROY4VVaE7jbalQBYYnb_LztDtyxHF-jYiONzj1bvuOPD2fTEAK0MThdoNPnawPHDVY7tM1D-AkMqsPKPEpytsLCM3WjXg0eL8DG7vsIeZcmKmNCl2uNXP_QYZjgTmfEjGJvCmm8qHUJ82gQeP3ZCjw_oZ1Ll3IJQG9PWSEM2j8if4atZzo2vB3yHdwT9MoqPPXLvQ6VBqDTvNnS1w6co5GIsyP5YcVCvc5J8SpI2km7iuxWgDuTH-tFBn6v012qF5c8sOsOJaCVEZ5V47xaF6KcQTnSbqjSGyxPKWSnUvnC9RfA1o3sqmJduOO0aACSWnIBbVULhO--iZ5MbJuo9xjcOvOBz_-L2dpGl7j8Ktne609sNO0qEaO6nbgYGnGZbCfvEIeTBgtPv_RmTuam3mEY9Nq0Llxo1oyO95tja5BuKgRrcKfuNYBVUxvVjq6gStW8u216co6NFSL0tLwPjjunBfjeZOGo-8EM7dbCbT4bCzUyP8s3EPpR_1ZevvTOYSVFP31sDEi72l0ciz_sx_YVZTGIDrpqGYY33GwNumq2iKlEgJE5rjQeNDaEpILeCSMk6HDxyp52g2tyk9y6BvUZsIDHi7mYsZF_CLdNQ14s6pA7cSUSuQ_WNWKs8Xo36F9UqzarV53X3w9BBqNtbG48WpC8Toa4rVvUEjgMeSfjnue1QLiLf4hyAvxy8h71OQz-M3hsMyWehDYWeB9WZeFEgTjcTppWTqiE6lw8CG7_rsMI0jH13UNdeW9uiez-A6u7r1HTatPtR4DVmuDNx3J2QK1W4y-2HdT6o0qa74M5gcYoM9NbqnO7s4uN950fsG2yF-Bv3H1n04qk=)


<!-- ### Full
```plantuml
@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

title Container Diagram for EDA (Event-Driven Ansible) System - Actual Pod Architecture

Person(user, "User", \
"System administrator or developer managing automation" \
)
System_Ext(external_system, "External Systems", \
"Systems that trigger events or receive notifications"\
)

System_Boundary(eda_system, "EDA System") {
    
    Boundary(api_pod, "API Pod (3 containers)") {
        Container(nginx_api, "Nginx Proxy", "nginx", \
        "Reverse proxy, static files, SSL termination (port 8000)", \
         $sprite="web_browser")
        Container(api, "EDA API", "Python/Django/Gunicorn", \
        "REST API server (internal port 8002)", \
        $sprite="server")
        Container(daphne, "EDA Daphne", "Python/ASGI", \
        "WebSocket server for real-time communication (port 8001)", \
         $sprite="websocket")
    }
    
    Boundary(event_stream_pod, "Event Stream Pod (2 containers)") {
        Container(nginx_event, "Nginx Proxy", "nginx", \
        "Reverse proxy for event stream (port 8000)", \
        $sprite="web_browser")
        Container(event_stream, "Event Stream", "Python/Django/Gunicorn", \
        "Event processing server (internal port 8002)", \
        $sprite="message_broker")
    }
    
    Container(ui, "EDA UI", "React/Web", \
    "Web interface served via LoadBalancer", \
    $sprite="web_browser")
    
    Container(activation_worker, "Activation Workers", "Python/RQ", \
    "Execute rulebook activations using RQ workers (2 instances)", \
    $sprite="worker")
    
    Container(default_worker, "Default Workers", "Python/RQ", \
    "Handle background tasks using RQ workers (2 instances)", \
    $sprite="worker")
    
    Container(scheduler, "EDA Scheduler", "Python/RQ Scheduler", \
    "EDA's custom scheduler for periodic tasks (2 instances)", \
    $sprite="clock")
    
    ContainerDb(postgres, "PostgreSQL Database", "PostgreSQL 15", \
    "Stores EDA configurations, rulebooks, activations, and audit logs", \
     $sprite="database")
    
    ContainerDb(redis, "Redis Cache", "Redis", \
    "Message broker for RQ and caching layer", \
    $sprite="cache")
}

Container(operator, "EDA Operator", "Go/Kubernetes Controller", \
"Manages EDA custom resources and deployment lifecycle", \
$sprite="kubernetes")

' User interactions
Rel(user, ui, "Uses", "HTTPS/HTTP")
Rel(user, nginx_api, "API calls", "HTTP/REST")

' External system interactions
Rel(external_system, nginx_event, "Sends events", "HTTP/WebHooks")
Rel(activation_worker, external_system, "Executes actions", "Various protocols")

' Internal pod relationships
Rel(nginx_api, api, "Proxies API calls", "HTTP (port 8002)")
Rel(nginx_api, daphne, "Proxies WebSocket", "HTTP (port 8001)")
Rel(nginx_event, event_stream, "Proxies events", "HTTP (port 8002)")

' UI interactions
Rel(ui, nginx_api, "Fetches data", "HTTP/REST")
Rel(ui, daphne, "Real-time updates", "WebSocket")

' Database and cache connections
Rel(api, postgres, "Reads/Writes", "SQL")
Rel(api, redis, "Caches data", "Redis Protocol")

Rel(daphne, postgres, "Reads data", "SQL")
Rel(daphne, redis, "Pub/Sub", "Redis Protocol")

Rel(event_stream, postgres, "Stores events", "SQL")
Rel(event_stream, redis, "Queues events", "Redis Protocol")

Rel(activation_worker, postgres, "Reads/Writes", "SQL")
Rel(activation_worker, redis, "Task queue", "RQ/Redis")

Rel(default_worker, postgres, "Reads/Writes", "SQL")
Rel(default_worker, redis, "Task queue", "RQ/Redis")

Rel(scheduler, redis, "Schedules tasks", "")
Rel(scheduler, postgres, "Reads schedules", "SQL")

' Operator relationships

Rel(operator, eda_system, "Manages", "Kubernetes API")

' Service discovery
Rel(nginx_api, event_stream, "Internal routing", "Kubernetes Service")

SHOW_LEGEND()

@enduml
```

### No Description
```plantuml
@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

title Container Diagram for EDA (Event-Driven Ansible) System - Actual Pod Architecture

Person(user, "User", \
'''"System administrator or developer managing automation" \
)
System_Ext(external_system, "External Systems", \
'''"Systems that trigger events or receive notifications"\
)

System_Boundary(eda_system, "EDA System") {
    
    Boundary(api_pod, "API Pod (3 containers)") {
        Container(nginx_api, "Nginx Proxy", "nginx", \
        '''"Reverse proxy, static files, SSL termination (port 8000)", \
         $sprite="web_browser")
        Container(api, "EDA API", "Python/Django/Gunicorn", \
        '''"REST API server (internal port 8002)", \
        $sprite="server")
        Container(daphne, "EDA Daphne", "Python/ASGI", \
        '''"WebSocket server for real-time communication (port 8001)", \
         $sprite="websocket")
    }
    
    Boundary(event_stream_pod, "Event Stream Pod (2 containers)") {
        Container(nginx_event, "Nginx Proxy", "nginx", \
        '''"Reverse proxy for event stream (port 8000)", \
        $sprite="web_browser")
        Container(event_stream, "Event Stream", "Python/Django/Gunicorn", \
        '''"Event processing server (internal port 8002)", \
        $sprite="message_broker")
    }
    
    Container(ui, "EDA UI", "React/Web", \
    '''"Web interface served via LoadBalancer", \
    $sprite="web_browser")
    
    Container(activation_worker, "Activation Workers", "Python/RQ", \
    '''"Execute rulebook activations using RQ workers (2 instances)", \
    $sprite="worker")
    
    Container(default_worker, "Default Workers", "Python/RQ", \
    '''"Handle background tasks using RQ workers (2 instances)", \
    $sprite="worker")
    
    Container(scheduler, "EDA Scheduler", "Python/RQ Scheduler", \
    '''"EDA's custom scheduler for periodic tasks (2 instances)", \
    $sprite="clock")
    
    ContainerDb(postgres, "PostgreSQL Database", "PostgreSQL 15", \
    '''"Stores EDA configurations, rulebooks, activations, and audit logs", \
     $sprite="database")
    
    ContainerDb(redis, "Redis Cache", "Redis", \
    '''"Message broker for RQ and caching layer", \
    $sprite="cache")
}

Container(operator, "EDA Operator", "Go/Kubernetes Controller", \
'''"Manages EDA custom resources and deployment lifecycle", \
$sprite="kubernetes")

' User interactions
Rel(user, ui, "Uses", "HTTPS/HTTP")
Rel(user, nginx_api, "API calls", "HTTP/REST")

' External system interactions
Rel(external_system, nginx_event, "Sends events", "HTTP/WebHooks")
Rel(activation_worker, external_system, "Executes actions", "Various protocols")

' Internal pod relationships
Rel(nginx_api, api, "Proxies API calls", "HTTP (port 8002)")
Rel(nginx_api, daphne, "Proxies WebSocket", "HTTP (port 8001)")
Rel(nginx_event, event_stream, "Proxies events", "HTTP (port 8002)")

' UI interactions
Rel(ui, nginx_api, "Fetches data", "HTTP/REST")
Rel(ui, daphne, "Real-time updates", "WebSocket")

' Database and cache connections
Rel(api, postgres, "Reads/Writes", "SQL")
Rel(api, redis, "Caches data", "Redis Protocol")

Rel(daphne, postgres, "Reads data", "SQL")
Rel(daphne, redis, "Pub/Sub", "Redis Protocol")

Rel(event_stream, postgres, "Stores events", "SQL")
Rel(event_stream, redis, "Queues events", "Redis Protocol")

Rel(activation_worker, postgres, "Reads/Writes", "SQL")
Rel(activation_worker, redis, "Task queue", "RQ/Redis")

Rel(default_worker, postgres, "Reads/Writes", "SQL")
Rel(default_worker, redis, "Task queue", "RQ/Redis")

Rel(scheduler, redis, "Schedules tasks", "")
Rel(scheduler, postgres, "Reads schedules", "SQL")

' Operator relationships

Rel(operator, eda_system, "Manages", "Kubernetes API")

' Service discovery
Rel(nginx_api, event_stream, "Internal routing", "Kubernetes Service")

SHOW_LEGEND()

@enduml
``` -->